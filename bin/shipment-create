#!/bin/bash
set -e

if [ "$1" == "_description" ]; then
  echo "Create new app"
  exit
fi

usage_create() {
  cat <<-EOF

  Usage: shipment create [options] [name]

  Options:

    Required:
    -r,--repo <repo>              repo [git@github.com:firstandthird/app]

    Optional:
    -h,--host <host>              host name [example.com]
    -p,--port <port>              internal port to expose [default: 5000]
    -e,--env <key=value>          environment variables
    -v,--volume <host:container>  docker volumes
    -l,--link <app:app>           docker containers to link

EOF
}
if [ "$#" == 0 ]; then
  usage_create
  exit
fi
main() {
  local name=""
  parseconfig $@
  writeconfig $name $@

  log "$name created"
  exec $SCRIPT info $name
  log "run \"shipment deploy $name\" to deploy"
}

main "$@"
