#!/bin/bash
set -e

IDONLY=0
PORT=${SHIPMENT_PORT:-5000}

if [ "$1" == "_description" ]; then
  echo "Run an app"
  exit
fi


while getopts "in:p:d:t:u:" OPTION "$@"; do
  case $OPTION in
    n) NAME=$OPTARG;;
    t) TAG=$OPTARG;;
    p) PORT=$OPTARG;;
    d) DOCKERARGS=$OPTARG;;
    u) URL=$OPTARG;;
    i) IDONLY=1;;
  esac
done

CONTAINER_ID=$(sudo docker run -d -p $PORT -e VIRTUAL_HOST=$URL -e PORT=$PORT $DOCKERARGS shipment/$NAME:$TAG)
echo $CONTAINER_ID
